use mavenmovies;

/*
1.	We will need a list of all staff members, including their first and last names, 
email addresses, and the store identification number where they work. 
*/ 

mysql> select staff_id, first_name, last_name, email, store_id from staff;
+----------+------------+-----------+------------------------------+----------+
| staff_id | first_name | last_name | email                        | store_id |
+----------+------------+-----------+------------------------------+----------+
|        1 | Mike       | Hillyer   | Mike.Hillyer@sakilastaff.com |        1 |
|        2 | Jon        | Stephens  | Jon.Stephens@sakilastaff.com |        2 |
+----------+------------+-----------+------------------------------+----------+
2 rows in set (0.00 sec)

/*
2.	We will need separate counts of inventory items held at each of your two stores. 
*/ 

mysql> select store_id, count(*) from inventory group by store_id;
+----------+----------+
| store_id | count(*) |
+----------+----------+
|        1 |     2270 |
|        2 |     2311 |
+----------+----------+
2 rows in set (0.00 sec)


/*
3.	We will need a count of active customers for each of your stores. Separately, please. 
*/

mysql> select store_id, count(*) as totCustomers from customer where active = 1 group by store_id;
+----------+--------------+
| store_id | totCustomers |
+----------+--------------+
|        1 |          318 |
|        2 |          266 |
+----------+--------------+
2 rows in set (0.00 sec)

/*
4.	In order to assess the liability of a data breach, we will need you to provide a count 
of all customer email addresses stored in the database. 
*/

mysql> select count(*) From customer where email <> '';
+----------+
| count(*) |
+----------+
|      599 |
+----------+
1 row in set (0.00 sec)

/*
5.	We are interested in how diverse your film offering is as a means of understanding how likely 
you are to keep customers engaged in the future. Please provide a count of unique film titles 
you have in inventory at each store and then provide a count of the unique categories of films you provide. 
*/

mysql> select store_id, count(distinct title) from film join inventory on inventory.film_id = film.film_id group by store_id;
+----------+-----------------------+
| store_id | count(distinct title) |
+----------+-----------------------+
|        1 |                   759 |
|        2 |                   762 |
+----------+-----------------------+
2 rows in set (0.02 sec)

mysql> select   category_id,  count(distinct film_id) from film_category group by  category_id order by category_id;
+-------------+-------------------------+
| category_id | count(distinct film_id) |
+-------------+-------------------------+
|           1 |                      64 |
|           2 |                      66 |
|           3 |                      60 |
|           4 |                      57 |
|           5 |                      58 |
|           6 |                      68 |
|           7 |                      62 |
|           8 |                      69 |
|           9 |                      73 |
|          10 |                      61 |
|          11 |                      56 |
|          12 |                      51 |
|          13 |                      63 |
|          14 |                      61 |
|          15 |                      74 |
|          16 |                      57 |
+-------------+-------------------------+
16 rows in set (0.00 sec)

/*
6.	We would like to understand the replacement cost of your films. 
Please provide the replacement cost for the film that is least expensive to replace, 
the most expensive to replace, and the average of all films you carry. ``	
*/

mysql> select
    -> min(replacement_cost),
    -> max(replacement_cost), avg(replacement_cost)
    -> from film ;
+-----------------------+-----------------------+-----------------------+
| min(replacement_cost) | max(replacement_cost) | avg(replacement_cost) |
+-----------------------+-----------------------+-----------------------+
|                  9.99 |                 29.99 |             19.984000 |
+-----------------------+-----------------------+-----------------------+
1 row in set (0.02 sec)

/*
7.	We are interested in having you put payment monitoring systems and maximum payment 
processing restrictions in place in order to minimize the future risk of fraud by your staff. 
Please provide the average payment you process, as well as the maximum payment you have processed.
*/

mysql> select avg(amount),
    -> max(amount) from payment;
+-------------+-------------+
| avg(amount) | max(amount) |
+-------------+-------------+
|    4.200667 |       11.99 |
+-------------+-------------+
1 row in set (0.01 sec)

/*
8.	We would like to better understand what your customer base looks like. 
Please provide a list of all customer identification values, with a count of rentals 
they have made all-time, with your highest volume customers at the top of the list.
*/

mysql> select customer_id, count(rental_id) from payment group by customer_id order by count(rental_id) desc;
+-------------+------------------+
| customer_id | count(rental_id) |
+-------------+------------------+
|         148 |               46 |
|         526 |               45 |
|         236 |               42 |
|         144 |               42 |
|          75 |               41 |
|         469 |               40 |
|         197 |               40 |
|         137 |               39 |
|         468 |               39 |
|         178 |               39 |
|           5 |               38 |
|         459 |               38 |
|         295 |               38 |
|         410 |               38 |
|         257 |               37 |
|         366 |               37 |
|         176 |               37 |
|         198 |               37 |
|         439 |               36 |
|          29 |               36 |
|         380 |               36 |
|         354 |               36 |
|         348 |               36 |
|         267 |               36 |
|         506 |               35 |
|          21 |               35 |
|          50 |               35 |
|         273 |               35 |
|          91 |               35 |
|         368 |               35 |
|         373 |               35 |
|         381 |               35 |
|         274 |               35 |
|         204 |               35 |
|         403 |               35 |
|         371 |               35 |
|         196 |               35 |
|          26 |               34 |
|          30 |               34 |
|          38 |               34 |
|          46 |               34 |
|          66 |               34 |
|         239 |               34 |
|         360 |               34 |
|         576 |               34 |
|         372 |               34 |
|         502 |               34 |
|         119 |               34 |
|         566 |               34 |
|         129 |               34 |
|         138 |               34 |
|         207 |               34 |
|         147 |               34 |
|         473 |               34 |
|         241 |               34 |
|         168 |               34 |
|         181 |               34 |
|         211 |               34 |
|         438 |               33 |
|           7 |               33 |
|         390 |               33 |
|          51 |               33 |
|          64 |               33 |
|         237 |               33 |
|         451 |               33 |
|          84 |               33 |
|          86 |               33 |
|         230 |               33 |
|         297 |               33 |
|         102 |               33 |
|         533 |               33 |
|         114 |               33 |
|         522 |               33 |
|         454 |               33 |
|         172 |               33 |
|         462 |               33 |
|         314 |               33 |
|           1 |               32 |
|         306 |               32 |
|         532 |               32 |
|          15 |               32 |
|         452 |               32 |
|         244 |               32 |
|         254 |               32 |
|         520 |               32 |
|          28 |               32 |
|         569 |               32 |
|          35 |               32 |
|         259 |               32 |
|         406 |               32 |
|         242 |               32 |
|         503 |               32 |
|         329 |               32 |
|         209 |               32 |
|         277 |               32 |
|         470 |               32 |
|         245 |               32 |
|          89 |               32 |
|         535 |               32 |
|         362 |               32 |
|         120 |               32 |
|         122 |               32 |
|         125 |               32 |
|         550 |               32 |
|         128 |               32 |
|         141 |               32 |
|         342 |               32 |
|         158 |               32 |
|         167 |               32 |
|         346 |               32 |
|         405 |               32 |
|         442 |               32 |
|         393 |               31 |
|         279 |               31 |
|          27 |               31 |
|         416 |               31 |
|         251 |               31 |
|         446 |               31 |
|         361 |               31 |
|         323 |               31 |
|          78 |               31 |
|         340 |               31 |
|         260 |               31 |
|         513 |               31 |
|         103 |               31 |
|         293 |               31 |
|         300 |               31 |
|         157 |               31 |
|         210 |               31 |
|         479 |               31 |
|         494 |               31 |
|         186 |               31 |
|         309 |               31 |
|         214 |               31 |
|         499 |               30 |
|         275 |               30 |
|         256 |               30 |
|         436 |               30 |
|          20 |               30 |
|          23 |               30 |
|         336 |               30 |
|          42 |               30 |
|         418 |               30 |
|          53 |               30 |
|          56 |               30 |
|         444 |               30 |
|         296 |               30 |
|          71 |               30 |
|          72 |               30 |
|          80 |               30 |
|          87 |               30 |
|         560 |               30 |
|         339 |               30 |
|         404 |               30 |
|         289 |               30 |
|         107 |               30 |
|         108 |               30 |
|         112 |               30 |
|         115 |               30 |
|         131 |               30 |
|         388 |               30 |
|         135 |               30 |
|         391 |               30 |
|         334 |               30 |
|         584 |               30 |
|         595 |               30 |
|         299 |               30 |
|         154 |               30 |
|         408 |               30 |
|         161 |               30 |
|         472 |               30 |
|         347 |               30 |
|         307 |               30 |
|         356 |               30 |
|         484 |               30 |
|         424 |               30 |
|         269 |               30 |
|         319 |               30 |
|         337 |               29 |
|          25 |               29 |
|          39 |               29 |
|         349 |               29 |
|          52 |               29 |
|          54 |               29 |
|         529 |               29 |
|         481 |               29 |
|         316 |               29 |
|         287 |               29 |
|         113 |               29 |
|         447 |               29 |
|         253 |               29 |
|         363 |               29 |
|         302 |               29 |
|         163 |               29 |
|         173 |               29 |
|         482 |               29 |
|         179 |               29 |
|         263 |               29 |
|         265 |               29 |
|         268 |               29 |
|         302 |               29 |
|         287 |               29 |
|           6 |               28 |
|         500 |               28 |
|          12 |               28 |
|          14 |               28 |
|          16 |               28 |
|         332 |               28 |
|          49 |               28 |
|          57 |               28 |
|         374 |               28 |
|          77 |               28 |
|         376 |               28 |
|         461 |               28 |
|          90 |               28 |
|          92 |               28 |
|         338 |               28 |
|         497 |               28 |
|         589 |               28 |
|         400 |               28 |
|         126 |               28 |
|         132 |               28 |
|         145 |               28 |
|         457 |               28 |
|         166 |               28 |
|         559 |               28 |
|         558 |               28 |
|         187 |               28 |
|         322 |               28 |
|         574 |               28 |
|         213 |               28 |
|         317 |               28 |
|         221 |               28 |
|         596 |               28 |
|         441 |               28 |
|         262 |               28 |
|         515 |               28 |
|         266 |               28 |
|         276 |               28 |
|         504 |               28 |
|         283 |               28 |
|         284 |               28 |
|         290 |               28 |
|           2 |               27 |
|          13 |               27 |
|          36 |               27 |
|         421 |               27 |
|          40 |               27 |
|          45 |               27 |
|          58 |               27 |
|          59 |               27 |
|         498 |               27 |
|          74 |               27 |
|         580 |               27 |
|         561 |               27 |
|          96 |               27 |
|         434 |               27 |
|         116 |               27 |
|         133 |               27 |
|         591 |               27 |
|         139 |               27 |
|         151 |               27 |
|         160 |               27 |
|         383 |               27 |
|         426 |               27 |
|         471 |               27 |
|         190 |               27 |
|         579 |               27 |
|         200 |               27 |
|         206 |               27 |
|         577 |               27 |
|         396 |               27 |
|         581 |               27 |
|         220 |               27 |
|         228 |               27 |
|         491 |               27 |
|         594 |               27 |
|         407 |               27 |
|         331 |               27 |
|         280 |               27 |
|         282 |               27 |
|         286 |               27 |
|         292 |               27 |
|         333 |               27 |
|          31 |               26 |
|         303 |               26 |
|         121 |               26 |
|         240 |               26 |
|         261 |               26 |
|         278 |               26 |
|         285 |               26 |
|         294 |               26 |
|         298 |               26 |
|         303 |               26 |
|         304 |               26 |
|         312 |               26 |
|         327 |               26 |
|         357 |               26 |
|         377 |               26 |
|         385 |               26 |
|         387 |               26 |
|         389 |               26 |
|         411 |               26 |
|         422 |               26 |
|         423 |               26 |
|         425 |               26 |
|         445 |               26 |
|         450 |               26 |
|         474 |               26 |
|         486 |               26 |
|         487 |               26 |
|         495 |               26 |
|         510 |               26 |
|         512 |               26 |
|         516 |               26 |
|         518 |               26 |
|         551 |               26 |
|         570 |               26 |
|         587 |               26 |
|         593 |               26 |
|          10 |               25 |
|          24 |               25 |
|          41 |               25 |
|          60 |               25 |
|          63 |               25 |
|          69 |               25 |
|          83 |               25 |
|          98 |               25 |
|         150 |               25 |
|         155 |               25 |
|         156 |               25 |
|         188 |               25 |
|         193 |               25 |
|         199 |               25 |
|         201 |               25 |
|         229 |               25 |
|         232 |               25 |
|         235 |               25 |
|         264 |               25 |
|         270 |               25 |
|         305 |               25 |
|         308 |               25 |
|         324 |               25 |
|         326 |               25 |
|         330 |               25 |
|         343 |               25 |
|         359 |               25 |
|         369 |               25 |
|         384 |               25 |
|         414 |               25 |
|         417 |               25 |
|         419 |               25 |
|         433 |               25 |
|         435 |               25 |
|         456 |               25 |
|         460 |               25 |
|         463 |               25 |
|         507 |               25 |
|         508 |               25 |
|         517 |               25 |
|         528 |               25 |
|         531 |               25 |
|         536 |               25 |
|         537 |               25 |
|         546 |               25 |
|         562 |               25 |
|         572 |               25 |
|         582 |               25 |
|         590 |               25 |
|         597 |               25 |
|           8 |               24 |
|          11 |               24 |
|          19 |               24 |
|          34 |               24 |
|          43 |               24 |
|          73 |               24 |
|          99 |               24 |
|         100 |               24 |
|         101 |               24 |
|         104 |               24 |
|         123 |               24 |
|         127 |               24 |
|         130 |               24 |
|         153 |               24 |
|         175 |               24 |
|         227 |               24 |
|         243 |               24 |
|         258 |               24 |
|         288 |               24 |
|         351 |               24 |
|         375 |               24 |
|         382 |               24 |
|         427 |               24 |
|         455 |               24 |
|         475 |               24 |
|         490 |               24 |
|         511 |               24 |
|         527 |               24 |
|         534 |               24 |
|         540 |               24 |
|         541 |               24 |
|         553 |               24 |
|         557 |               24 |
|         564 |               24 |
|         571 |               24 |
|         585 |               24 |
|           9 |               23 |
|          37 |               23 |
|          62 |               23 |
|          76 |               23 |
|          85 |               23 |
|          93 |               23 |
|         106 |               23 |
|         134 |               23 |
|         177 |               23 |
|         180 |               23 |
|         183 |               23 |
|         184 |               23 |
|         185 |               23 |
|         192 |               23 |
|         216 |               23 |
|         217 |               23 |
|         233 |               23 |
|         246 |               23 |
|         249 |               23 |
|         291 |               23 |
|         311 |               23 |
|         313 |               23 |
|         328 |               23 |
|         335 |               23 |
|         341 |               23 |
|         345 |               23 |
|         350 |               23 |
|         352 |               23 |
|         364 |               23 |
|         365 |               23 |
|         379 |               23 |
|         392 |               23 |
|         409 |               23 |
|         415 |               23 |
|         431 |               23 |
|         432 |               23 |
|         437 |               23 |
|         453 |               23 |
|         466 |               23 |
|         493 |               23 |
|         519 |               23 |
|         521 |               23 |
|         530 |               23 |
|         547 |               23 |
|         583 |               23 |
|           4 |               22 |
|          18 |               22 |
|          22 |               22 |
|          47 |               22 |
|          55 |               22 |
|          65 |               22 |
|          67 |               22 |
|          68 |               22 |
|          79 |               22 |
|          81 |               22 |
|         143 |               22 |
|         169 |               22 |
|         189 |               22 |
|         224 |               22 |
|         247 |               22 |
|         252 |               22 |
|         321 |               22 |
|         325 |               22 |
|         367 |               22 |
|         394 |               22 |
|         430 |               22 |
|         440 |               22 |
|         443 |               22 |
|         476 |               22 |
|         477 |               22 |
|         480 |               22 |
|         488 |               22 |
|         514 |               22 |
|         523 |               22 |
|         539 |               22 |
|         543 |               22 |
|         544 |               22 |
|         554 |               22 |
|         578 |               22 |
|         598 |               22 |
|          17 |               21 |
|          33 |               21 |
|          88 |               21 |
|          94 |               21 |
|         118 |               21 |
|         152 |               21 |
|         159 |               21 |
|         165 |               21 |
|         174 |               21 |
|         222 |               21 |
|         226 |               21 |
|         238 |               21 |
|         301 |               21 |
|         358 |               21 |
|         399 |               21 |
|         401 |               21 |
|         412 |               21 |
|         413 |               21 |
|         420 |               21 |
|         429 |               21 |
|         489 |               21 |
|         496 |               21 |
|         501 |               21 |
|         505 |               21 |
|         545 |               21 |
|         552 |               21 |
|         556 |               21 |
|         568 |               21 |
|         162 |               20 |
|         191 |               20 |
|         203 |               20 |
|         212 |               20 |
|         250 |               20 |
|         272 |               20 |
|         310 |               20 |
|         320 |               20 |
|         355 |               20 |
|         402 |               20 |
|         428 |               20 |
|         449 |               20 |
|         509 |               20 |
|         549 |               20 |
|         567 |               20 |
|         117 |               19 |
|         195 |               19 |
|         370 |               19 |
|         378 |               19 |
|         395 |               19 |
|         458 |               19 |
|         478 |               19 |
|         524 |               19 |
|         525 |               19 |
|         548 |               19 |
|         586 |               19 |
|         599 |               19 |
|          70 |               18 |
|          95 |               18 |
|          97 |               18 |
|         124 |               18 |
|         140 |               18 |
|         194 |               18 |
|         205 |               18 |
|         218 |               18 |
|         255 |               18 |
|         271 |               18 |
|         344 |               18 |
|         353 |               18 |
|         483 |               18 |
|         542 |               18 |
|          48 |               17 |
|         223 |               17 |
|         315 |               17 |
|         465 |               17 |
|         555 |               17 |
|         164 |               16 |
|         398 |               16 |
|         464 |               16 |
|         492 |               16 |
|         136 |               15 |
|         248 |               15 |
|          61 |               14 |
|         110 |               14 |
|         281 |               14 |
|         318 |               12 |
+-------------+------------------+
599 rows in set (0.02 sec)
